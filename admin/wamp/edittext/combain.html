<!DOCTYPE html>
<html lang="en">
<title>edit text</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        font-family: "Lato", sans-serif
    }
    
    .mySlides {
        display: none
    }
</style>

<body>

    <form action="">
        <textarea id="textarea" name="text" rows="30" cols="120"></textarea>
        <br><br>
        <label id="cols"></label>
        <br><br>
        <input id="submit" onclick="editText()" value="Submit">
    </form>
    <script>
        function editText() {

            var textArea = getElement("textarea");
            var text = textArea.value;

            textArea.value = combineTextByGroup(text.split("\n"));

            getElement("submit").value = "done!";
            return false;
        }

        function combineTextByGroup(data) {
            // Initialize an empty object to store the combined text for each group
            const combinedText = {};

            // Loop through each row in the data
            data.forEach((row) => {
                // Split the row into an array of values
                const values = row.split(',');

                // Get the value of column A (group)
                const group = values[0];

                // Loop through each column (starting from column B)
                for (let i = 1; i < values.length; i++) {
                    const text = values[i].trim(); // Remove any leading/trailing whitespace

                    // If the group already exists in the combinedText object, append the text to it
                    if (combinedText[group]) {
                        combinedText[group][i - 1] += "," + text;
                    }
                    // If the group doesn't exist in the combinedText object, initialize it with the text
                    else {
                        combinedText[group] = [];
                        combinedText[group][i - 1] = text;
                    }
                }
            });

            // Initialize a string to store the CSV output
            let output = "A,";

            // Loop through each column and add its header to the output string
            for (let i = 1; i < data[0].split(',').length; i++) {
                output += `Col ${i},`;
            }
            output = output.slice(0, -1) + "\n"; // Remove the trailing comma and add a newline character

            // Loop through each group in the combinedText object and add it to the output string
            Object.entries(combinedText).forEach(([group, textArray]) => {
                const row = `${group},"${textArray.join('","')}"\n`;
                output += row;
            });

            // Return the CSV output
            return output;
        }



        function getElement(id) {
            return document.getElementById(id);
        }
    </script>

</body>

</html>