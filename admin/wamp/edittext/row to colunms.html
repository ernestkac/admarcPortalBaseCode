<!DOCTYPE html>
<html lang="en">
<title>edit text</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        font-family: "Lato", sans-serif
    }
    
    .mySlides {
        display: none
    }
</style>

<body>

    <form action="">
        <textarea id="textarea" name="text" rows="30" cols="120"></textarea>
        <br><br>
        <label id="cols"></label>
        <br><br>
        <input id="submit" onclick="editText()" value="Submit">
    </form>
    <script>
        function editText() {

            var textArea = getElement("textarea");
            var text = textArea.value;

            //text = text.replaceAll("\n", "',.'");
            text = text.replaceAll("    ", "");
            text = text.replaceAll(" ", "");
            text = text.replaceAll(".", "");
            text = text.replaceAll("-", "_");
            //text = text.replaceAll("\n", "'),\n('");
            /*text = text.replaceAll(",", "\',\n'");
            //text = text + ".";
            //text = text.replace(",\n('.", ");");*/
            //text = text + "')";

            const array = text.split('\n');
            var textToBe = "";
            for (let index = 0; index < array.length; index++) {
                const item1 = array[index].split("	");
                textToBe = textToBe + "MAX(CASE WHEN EarnDedId = '" + item1[0] + "' THEN USER4 END) AS " + item1[1] + ' ,\n';
            }

            textArea.value = textToBe;

            getElement("submit").value = "done!";
            return false;
        }

        function getElement(id) {
            return document.getElementById(id);
        }
    </script>

</body>

</html>